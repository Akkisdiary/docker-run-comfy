#!/bin/bash

# HuggingFace Download Script
# Downloads models from HuggingFace URLs

set +e  # Don't exit on errors

# Function to download from HuggingFace
download_huggingface() {
    local download_url="$1"
    local target_file_path="$2"
    
    # Extract directory and filename from target path
    local target_dir=$(dirname "$target_file_path")
    local filename=$(basename "$target_file_path")
    
    echo "ü§ó Downloading HuggingFace model: $filename"
    echo "üìÅ Target file: $target_file_path"
    echo "üì• URL: $download_url"
    
    # Create target directory if it doesn't exist
    mkdir -p "$target_dir"
    
    # Use aria2 for direct URL download (faster and more reliable)
    aria2c -x 16 -s 16 -k 1M -d "$target_dir" -o "$filename" \
        --max-tries=3 --retry-wait=5 \
        --auto-file-renaming=false --continue=true \
        "$download_url"
    
    if [ $? -eq 0 ]; then
        echo "‚úÖ HuggingFace download completed for $download_url"
    else
        echo "‚ùå HuggingFace download failed for $download_url"
        return 1
    fi
}

# Call the function with all arguments
download_huggingface "$@"
